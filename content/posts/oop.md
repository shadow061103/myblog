---
title: "OOP物件導向"
date: 2022-10-20T17:02:58+08:00
draft: false
tags: ["Csharp"]
type: post
author: "Steve Lin"
description: ""
slug: "OOP物件導向"
---

# C# OOP物件導向
## 三大特性
### 繼承
> 繼承者會擁有被繼承者的型別特徵
- 繼承一個上層類別 (只能一個)
- 實做介面 (可以多個)
### 封裝
- 隱藏不必要為外界所知的資訊
- 隱藏行為的變化
- 隔離出物件的內部與外部，就是定義「物件的邊界」，以及定義出「外部可視部分」
- 將外部使用端不需要瞭解的物件內部資訊給封裝起來，也就是「封裝物件的實作細節」
- 將物件內部的變化封裝起來，也就是「封裝變化」
### 多型
> 父類別指標指向子類別物件
- 廣義多型 (universal polymorphism)
    - 繼承式多型 (inclusion):一般常見的
    - 參數式多型 (parametric):以參數型式，讓類別可以達到動態變化的方法(EX 泛型)
- 特設多型 (ad hoc polymorphism)
    - 多載 (overloading):表示使用同一個名稱但不同的參數清單，定義多個版本的程序
    - 強制同型 (coercions):會用到boxing跟unboxing EX (int)num

## 型別
### 參考型別
> 變數內容則是儲存指向物件的參考(指標)，存在 Heap
- 介面
- 類別
- 委派
### 實質型別
> 變數內容就是物件本身，存在於 Stack
>  變數與物件是一對一的關係
>  一定會繼承 System.ValueType
- 結構
- 列舉

### Boxing 與 UnBoxing
- 實質型別與參考型別之間的轉換
- 造成效能耗損

### 存取修飾字
- private (預設)
- internal
- protected
- protected internal
- public
### 其他修飾字
- abstract抽象
    - 類別 : 表示抽象類別，不具有公開建構式
    - 成員 : 表示為抽象成員，實做不完整，方法不提供實作， 非抽象衍生類別必須覆寫此方法，隱含virtual
```C#
public abstract class Test
    {
        public abstract int Add(int a, int b);
        
    }

    public class Test1 : Test
    {
        public override int Add(int a, int b)
        {
            return a + b;
        }
    }
```
- sealed
    - 類別 : 表示密封類別，此類別無法再被繼承
    - 成員 : 當套用至成員時，sealed 修飾詞必須一律和override 搭配使用，其衍生類別將無法再覆寫此成員
- virtual虛擬:允許在衍生類別中覆寫此成員，可以有實作
- new遮蔽:明確隱藏繼承自基底類別的成員，或稱為遮蔽
- override:覆寫基底類別的虛擬(virtual) 成員
    - 被覆寫的基底方法必須是虛擬、抽象或覆寫的執行個體方法(不能靜態或非虛擬、密封方法)
    

### 實質型別傳值/址
- 傳值:取出變數複製一份到方法中，變數位址不同，變數是儲存內容值
- 傳址:方法參數要加上ref，變數位址相同
### 參考型別傳值/址
- 傳值:取出變數值傳遞到方法中，變數位址不同，只能改變原來傳進去變數的值，改變位址就不是原本變數
- 傳址:取出變數的位址傳給方法，變數是儲存位址，改變值或new一個會改變原本變數

### 多載
> 同樣的方法名稱,不同的參數清單

### 靜態類別
- 只包含靜態成員
- 無法產生實體
- 一定是密封的, 無法被繼承
- 基底類別只能是 Object Type
- 沒有執行個體建構函式
### 靜態建構式
- 靜態建構函式可以用來初始化任何靜態資料，或執行只需執行一次的特定動作。 在建立第一個執行個體或參考任何靜態成員之前，會自動呼叫靜態建構函式。
- 靜態建構函式並**不使用存取修飾詞，也沒有參數**
- 在建立第一個執行個體或參考任何靜態成員之前，就會自動呼叫靜態建構函式以初始化類別
- 不能直接呼叫靜態建構函式
- 使用者無法控制程式中靜態建構函式執行的時間
- 靜態建構函式通常用在當類別使用記錄檔，而建構函式被用來將項目寫入該檔案
- 如果靜態建構函式擲回例外狀況，執行階段將不會再一次叫用它，且在您的程式執行的應用程式定義域存留期中，型別都將保持未初始化狀態
### 靜態成員
- 除非透過執行個體, 否則靜態成員是無法直接存取執行個體成員
- 靜態方法能多載但不能覆寫
- C# 不支援靜態區域變數
- 靜態方法與執行個體方法的選擇

### 共變逆變不變
- 共變性:用基底類別取代衍生類別
- 逆變性:用衍生類別取代基底類別